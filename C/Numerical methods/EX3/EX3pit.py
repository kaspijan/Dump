import numpy as np
import matplotlib.pyplot as plt

#x0 = [1.000000833531774,1.000000000083325,1.000000000000014,1.000000000000223,0.999999999995435,0.999999999973078,0.999999999473642,0.999999993922528]

#x1 = [2.718284094233320,2.718281828685573,2.718281828458752,2.718281828459140,2.718281828472327,2.718281828295134,2.718281828517627,2.718281821856293]

#x2 = [7.389062257943698,7.389056099546320,7.389056098930023,7.389056098938193,7.389056098993177,7.389056098981870,7.389056091433572,7.389056033701987]

#x3 = [20.085553665120898,20.085536924861117,20.085536923186091,20.085536923230659,20.085536923296033,20.085536926114344,20.085536895919589,20.085536789338210]

#x4 = [54.598195542437011,54.598150037692676,54.598150033148919,54.598150033152990,54.598150032148354,54.598150040154650,54.598150036610939,54.598149645812526]

#x5 = [148.413282809659900,148.413159114941210,148.413159102632050,148.413159102232100,148.413159097429120,148.413159124036380,148.413159593019030,148.413157319282530]

#x6 = [403.429129763451500,403.428793526346060,403.428793492865110,403.428793491760930,403.428793477571050,403.428793560966260,403.428794584214360,403.428791173609850]

#x7 = [1096.634072507036300,1096.633158519828800,1096.633158428833900,1096.633158426037000,1096.633158378975600,1096.633158567600300,1096.633161523639000,1096.633150154957100]

#x8 = [2980.960471764915800,2980.957987290083600,2980.957987041320800,2980.957987033285000,2980.957986933728500,2980.957986209844000,2980.957981435488400,2980.958106491014900]

#x9 = [8103.090681753271400,8103.083928250478500,8103.083927571028700,8103.083927554452200,8103.083927291213500,8103.083921467725300,8103.083878268063000,8103.084610411310700]

#x10 = [22026.484154565744000,22026.465796641842000,22026.465794793196000,22026.465794748281000,22026.465793893611000,22026.465778249945000,22026.465667295222000,22026.467559044238000]
x0 = [1.001667500198441,1.000016666749992,1.000000166666681,1.000000001666890,1.000000000012102,0.999999999973244,0.999999999473644,0.999999993922528]
x1 = [2.722814563947418,2.718327133382714,2.718282281505724,2.718281832989610,2.718281828517631,2.718281828295587,2.718281828517631,2.718281821856293]
x2 = [7.401377351441916,7.389179250481302,7.389057330439373,7.389056111253287,7.389056099116329,7.389056098983102,7.389056091433584,7.389056033701987]
x3 = [20.119029559992878,20.085871683809838,20.085540270775578,20.085536956706555,20.085536923630791,20.085536926117690,20.085536895919621,20.085536789338210]
x4 = [54.689192459158917,54.599060006859894,54.598159132840593,54.598150124149910,54.598150033058324,54.598150040163752,54.598150036611031,54.598149645812526]
x5 = [148.660638074830870,148.415632667592920,148.413183838158570,148.413159349587370,148.413159099902660,148.413159124061110,148.413159593019290,148.413157319282530]
x6 = [404.101511085939360,403.435517339570940,403.428860730997370,403.428794164142230,403.428793484294890,403.428793561033500,403.428794584215040,403.428791173609850]
x7 = [1098.461794437750300,1096.651435739135900,1096.633341201027000,1096.633160253758900,1096.633158397252800,1096.633158567783100,1096.633161523640900,1096.633150154957100]
x8 = [2985.928735076652200,2981.007669923200900,2980.958483867651900,2980.957992001548500,2980.957986983411000,2980.957986210341000,2980.957981435493400,2980.958106491014900]
x9 = [8116.595821632563500,8103.218979649271200,8103.085278085016400,8103.083941059591800,8103.083927426265300,8103.083921469075900,8103.083878268076700,8103.084610411310700]
x10= [22063.194930890422000,22026.832904405088000,22026.469465870829000,22026.465831459056000,22026.465794260719000,22026.465778253616000,22026.465667295259000,22026.467559044238000]
#these are results from C++ code


dexp = [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10]  #first derivatives using three point formula


y0 = [1.000833611160701, 1.000008333358337, 1.000000083628549, 0.999999993922528, 1.000000082740370, 1.000088900582340, 0.976996261670137, 0.000000000000000]

y1 = [2.720547818529351, 2.718304480877619, 2.718282055447218, 2.718281866265214, 2.718287817060625, 2.718714142702082, 2.753353101070385, 0.000000000000000]

y2 = [7.395215698561941, 7.389117674598819, 7.389056715823013, 7.389056122519828, 7.389040490579640, 7.389644451905037, 7.105427357600996, 0.000000000000000]

y3 = [20.102280450936405, 20.085704303198774, 20.085538594116763, 20.085536789338210, 20.085551000192918, 20.079937712580417, 19.895196601282787, 0.000000000000000]

y4 = [54.643663660364439, 54.598605019293679, 54.598154605400822, 54.598147869455680, 54.597961707258904, 54.598103815806056, 56.843418860807965, 0.000000000000000]

y5 = [148.536877968405180, 148.414395882809860, 148.413171473293860, 148.413158740368000, 148.413050737872140, 148.418166645569610, 147.792889038100700, 568.434188608079580]

y6 = [403.765096237543730, 403.432155411564790, 403.428827098650570, 403.428794015780740, 403.427975470549090, 403.474587074014950, 409.272615797817310, 1136.868377216159200]

y7 = [1097.547324068546000, 1096.642297070502100, 1096.633250199374300, 1096.633150154956900, 1096.632331609725000, 1096.850610338150500, 1136.868377216159200, 4547.473508864636600]

y8 = [2983.442946889408600, 2980.982828439663100, 2980.958232910778000, 2980.958015541543800, 2980.959834530946900, 2977.685653604564800, 2728.484105318782400, 27284.841053187818000]

y9 = [8109.838748773472600, 8103.151453506140600, 8103.084603135354000, 8103.083928290284300, 8103.088475763791400, 8101.778803393238400, 8003.553375601760300, 0.000000000000000]

y10 = [22044.827302524209000, 22026.649349281786000, 22026.467631803818000, 22026.465740054831000, 22026.433725841325000, 22017.047740519032000, 21827.872842550260000, 0.000000000000000]
#taken from C++


d2exp = [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10]  #second derivative with three point formula

h = [i for i in range(-1, -9, -1)]

def error(x, func):
    #func is an array of which we calculate error, so dexp or d2exp
    #x is the value for which error is calculated
    temp = []
    t = 0
    for i in range(0, 8):
        t = (func[x][i] - np.exp(x)) / np.exp(x)
        t = np.log10(np.abs(t))
        temp.append(t)
        
    return temp

for i in range(0, 11):
    plt.plot(h, error(i, dexp))
    plt.title("Error plot of first derivative for x = " + (str)(i))
    plt.xlabel("$log_{10}(h)$")
    plt.ylabel("$\epsilon$")
    plt.xlim(-10, 0)
    plt.show()

for i in range(0, 11):
    plt.plot(h, error(i, d2exp))
    plt.title("Error plot of second derivative for x = " + (str)(i))
    plt.xlabel("$log_{10}(h)$")
    plt.ylabel("$\epsilon$")
    plt.xlim(-10, 0)
    plt.show()
